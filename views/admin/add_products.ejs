<!-- ============================================================== -->
<!-- Start right Content here -->
<!-- ============================================================== -->
<div class="main-content">

  <div class="page-content">
    <div class="container-fluid">

      <!-- start page title -->
      <div class="row">
        <div class="col-12">
          <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="">Product Management</h4>

            <div class="page-title-right">
              <ol class="breadcrumb m-0">
                <li class="breadcrumb-item"><a href="javascript: void(0);">Admin</a></li>
                <li class="breadcrumb-item active">Product Management</li>
                <li class="breadcrumb-item active">Add Product</li>
              </ol>
            </div>

          </div>
        </div>
      </div>
      <!-- end page title -->

      <section class="content-main" style="max-width: 720px">

        <div class="content-header">
          <h2 class="content-title">Create product </h2>
        </div>

        <div class="card mb-4">
          <div class="card-body">
            <form id="uploadForm" onsubmit="return validateform()" action="/admin/add_product"
              enctype="multipart/form-data" method="post">
              <div class="mb-4">
                <label for="product_name" class="form-label">Product Title</label>
                <input type="text" name="producttitle" onchange="validateProductTitle()"
                  placeholder="Enter Product Title" class="form-control" id="product_title">
              </div>
              <div class="mb-4">
                <label for="product_name" class="form-label">Product Name</label>
                <input type="text" name="productname" onchange="validateProductName()" placeholder="Enter Product Name"
                  class="form-control" id="product_name">
              </div>

              <div class="mb-4">
                <label class="form-label">Product description</label>
                <textarea name="productdiscription" placeholder="Type here" onchange="validateProductDiscription()"
                  id="product_description" class="form-control" rows="4"></textarea>
              </div>

              <div class="row gx-2">
                <div class="col-sm-6 mb-3">
                  <label class="form-label">Price</label>
                  <input type="text" name="productprice" onchange="validateProductPrice()" placeholder="Enter Price"
                    class="form-control" id="product_price">
                  <span style="color: red;" class="" id="pricewarn"></span>
                </div>
                <div class="col-sm-6 mb-3">
                  <label class="form-label">Quantity</label>
                  <input type="text" name="productquantity" onchange="validateProducQuantity()"
                    placeholder="Enter Quantity" class="form-control" id="product_quantity">
                  <span style="color: red;" class="" id="quantitywarn"></span>
                </div>
              </div> <!-- row.// -->

              <!-- <div class="row gx-2">
                <div class="col-sm-6 mb-3">
                  <label class="form-label">Size</label>
                  <input type="text" name="productsize" onchange="validateProducSize()" placeholder="Enter Size"
                    class="form-control" id="product_size">
                </div>
                <div class="col-sm-6 mb-3">
                  <label class="form-label">Colour</label>
                  <input type="text" name="productcolour" onchange="validateProducColour()" placeholder="Enter Colour"
                    class="form-control" id="product_colour">
                </div>
              </div> row.// -->

              <div class="row gx-2">
                <div class="col-sm-6 mb-3">
                  <label class="form-label">Category</label>
                  <select id="getSubCat" onchange="getSubcategory()" class="form-select" name="productcategory">

                    <option value="">Select</option>
                    <%for(var i=0;i<data.length;i++){%>

                      <option>
                        <%=data[i].category%>
                      </option>
                      <%}%>

                  </select>
                </div>
                <div class="col-sm-6 mb-3">
                  <label class="form-label">Sub-category</label>
                  <select id="subcategory" class="form-select" name="productsubcategory">

                    <option id="" value=" ">Select</option>

                  </select>
                </div>
              </div> <!-- row.// -->



              <!--  -->

              <!-- <div class="container">
                <div class="row">
                  <div class="col-xs-12">
                    <label class="cabinet center-block">
                      <figure>
                        <img src="" class="gambar img-responsive img-thumbnail" id="item-img-output"
                          style="max-width: 200px; " />
                        <figcaption><i class="fa fa-camera"></i></figcaption>
                      </figure>
                      <input type="file" class="item-img file center-block" name="file_photo" />
                    </label>
                  </div>
                </div>
              </div>

              <div class="modal fade" id="cropImagePop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <h4 class="modal-title" id="myModalLabel">
                        <?=multiLanguage( "Edit Foto" , "Edit Photo" )?>
                      </h4>
                    </div>
                    <div class="modal-body">
                      <div id="upload-demo" class="center-block"></div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                      <button type="button" id="cropImageBtn" class="btn btn-primary">Crop</button>
                    </div>
                  </div>
                </div>
              </div> -->

              <!-- crop 2 -->

              <!-- <div class="container">
                <div class="row">
                  <div class="col-xs-12">
                    <label class="cabinet center-block">
                      <figure>
                        <img src="" class="gambar img-responsive img-thumbnail" id="item-img-output"
                          style="max-width: 200px; " />
                        <figcaption><i class="fa fa-camera"></i></figcaption>
                      </figure>
                      <input type="file" class="item-img file center-block" name="file_photo" />
                    </label>
                  </div>
                </div>
              </div>

              <div class="modal fade" id="cropImagePop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <h4 class="modal-title" id="myModalLabel">
                        <?=multiLanguage( "Edit Foto" , "Edit Photo" )?>
                      </h4>
                    </div>
                    <div class="modal-body">
                      <div id="upload-demo" class="center-block"></div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                      <button type="button" id="cropImageBtn" class="btn btn-primary">Crop</button>
                    </div>
                  </div>
                </div>
              </div> -->

              <!-- crop 2 -->


              <!--  -->


              <div class="row gx-2">
                <div class="mb-4 col-sm-3 mb-3">
                  <label class="cabinet center-block">
                    <figure>
                      <img style=" width: 100px;" src="/user/images/imgplaceholder.png"
                        class="gambar img-responsive img-thumbnail" id="uploadImage1" />
                    </figure>
                    <input type="file" class="item-img file center-block" id="image1" onchange="addImg(1)"
                      name="productimage1" required />
                  </label>
                </div>
                <div class="mb-4 col-sm-3 mb-3">
                  <label class="cabinet center-block">
                    <figure>
                      <img style=" width: 100px;" src="/user/images/imgplaceholder.png"
                        class="gambar img-responsive img-thumbnail" id="uploadImage2" />
                    </figure>
                    <input type="file" class="item-img file center-block" id="image2" onchange="addImg(2)"
                      name="productimage2" required />
                  </label>
                </div>
                <div class="mb-4 col-sm-3 mb-3">
                  <label class="cabinet center-block">
                    <figure>
                      <img style=" width: 100px;" src="/user/images/imgplaceholder.png"
                        class="gambar img-responsive img-thumbnail" id="uploadImage3" />
                    </figure>
                    <input type="file" class="item-img file center-block" id="image3" onchange="addImg(3)"
                      name="productimage3" required />
                  </label>
                </div>
                <div class="mb-4 col-sm-3 mb-3">
                  <label class="cabinet center-block">
                    <figure>
                      <img style=" width: 100px;" src="/user/images/imgplaceholder.png"
                        class="gambar img-responsive img-thumbnail" id="uploadImage4" />
                    </figure>
                    <input type="file" class="item-img file center-block" id="image4" onchange="addImg(4)" name="productimage4"
                      required />
                  </label>
                </div>
                <!-- <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Image 1</label>
                                    <input class="form-control" type="file" id="image1" onchange="addImg(1)" name="productimage1" required>
                                </div> -->
                <!-- end -->
                <!-- <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Images 2</label>
                                    <input class="form-control" type="file" id="image2" onchange="addImg(2)" name="productimage2" required>
                                </div>
                                <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Image 3</label>
                                    <input class="form-control" type="file" id="image3" onchange="addImg(3)" name="productimage3" required>
                                </div>
                                <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Image 4</label>
                                    <input class="form-control" type="file" id="image4" onchange="addImg(4)" name="productimage4" required>
                                </div> -->
              </div>

              <button type="submit" id="submit" class="btn btn-primary">Add item</button>

            </form>
          </div>
        </div> <!-- card end// -->


      </section> <!-- content-main end// -->
    </div>
    <!-- End Page-content -->
  </div>
  <!-- end main content-->

</div>
<!-- END layout-wrapper -->


<!-- JAVASCRIPT -->
<script src="/admin/libs/jquery/jquery.min.js"></script>
<!-- <script src="/admin/libs/bootstrap/js/bootstrap.bundle.min.js"></script> -->
<script src="/admin/libs/simplebar/simplebar.min.js"></script>
<!-- <script src="/admin/libs/node-waves/waves.min.js"></script> -->




</body>




<link rel="stylesheet" href="https://foliotek.github.io/Croppie/croppie.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">









<!-- card end// -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>














<!--  -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://foliotek.github.io/Croppie/croppie.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
  integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
  integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>


<!--  -->

<script>



  // var $uploadCrop,
  //             tempFilename,
  //             rawImg,
  //             imageId;

  // function readFile(input) {
  //   console.log(input);
  //   if (input.files && input.files[0]) {
  //     var reader = new FileReader();
  //     reader.onload = function (e) {
  //       // $('.upload-demo').addClass('ready');
  //       $('#cropImagePop').modal('show');
  //       rawImg = e.target.result;
  //       console.log(rawImg);
  //     }
  //     reader.readAsDataURL(input.files[0]);
  //   }
  //   else {
  //     swal("Sorry - you're browser doesn't support the FileReader API");
  //   }
  // }

  // $uploadCrop = $('#upload-demo').croppie({
  //   viewport: {
  //     width: 200,
  //     height: 225,
  //   },
  //   enforceBoundary: false,
  //   enableExif: true
  // });
  // $('#cropImagePop').on('shown.bs.modal', function () {
  //   // alert('Shown pop');
  //   $uploadCrop.croppie('bind', {
  //     url: rawImg
  //   }).then(function () {
  //     console.log('jQuery bind complete');
  //   });
  // });
  
  // $('.item-img').on('change', function () {
  //   imageId = $(this).data('id'); tempFilename = $(this).val();
  //   $('#cancelCropBtn').data('id', imageId); readFile(this);
  // });
  // $('#cropImageBtn').on('click', function (ev) {
  //   $uploadCrop.croppie('result', {
  //     type: 'base64',
  //     format: 'jpeg',
  //     size: { width: 800, height: 900 }
  //   }).then(function (resp) {
  //     $('#item-img-output').attr('src', resp);
  //     $('#cropImagePop').modal('hide');
  //   });
  // });
  // End upload preview image


  // 



  function addImg(id) {
    console.log(id);
    var oFReader = new FileReader();
    oFReader.readAsDataURL(document.getElementById("image" + id).files[0]);

    oFReader.onload = function (e) {
      document.getElementById("uploadImage" + id).src = e.target.result;
    }
  }


  // get subcategory 
  function getSubcategory() {

    let category = $('#getSubCat').val()
    $.ajax({

      url: '/admin/getSubCategory',
      method: 'post',
      data: { category: category },
      success: (response) => {
        console.log(response);
        // $('#subcategory').html = ''
        $("#subcategory").find('option').remove();
        for (var i = 0; i < response.length; i++) {
          console.log("hereeeeeeeeeeeeeeeeeeeeee");
          console.log(response);
          $("#subcategory").append('<option >' + response[i] + '</option>');
          // let sub = <option>response[i].name</option>
          // $('#subcategory').html+= sub
        }

      }

    })
  }



  // validation
  function validateform() {



    let productname = $('#product_name').val()
    let producttitle = $('#product_title').val()
    let productdiscription = $('#product_description').val()
    let productprice = $('#product_price').val()
    let productquantity = $('#product_quantity').val()
    // let productsize = $('#product_size').val()
    // let productcolour = $('#product_colour').val()
    let productcategory = $('#getSubCat').val()
    let productsubcategory = $('#subcategory').val()

    // product name
    let productNameError = true;

    function validateProductName() {

      let productname = $('#product_name').val()
      if (productname.length == '') {

        $('#product_name').css('border-color', '#f30000')
        $('#product_name').attr("placeholder", "Enter Product Name")
        productNameError = false;
        return false;

      }
    }

    // product Title
    let productTitleError = true;

    function validateProductTitle() {

      let productname = $('#product_title').val()
      if (productname.length == '') {

        $('#product_title').css('border-color', '#f30000')
        $('#product_title').attr("placeholder", "Enter Product Title")
        productTitleError = false;
        return false;
      }
    }
    // product discription
    let productDisError = true;

    function validateProductDiscription() {

      let productdiscription = $('#product_description').val()
      if (productdiscription.length == '') {

        $('#product_description').css('border-color', '#f30000')
        $('#product_description').attr("placeholder", "Enter Product Details")
        productDisError = false;
        return false;

      }
    }

    // product price
    let productPriceError = true;

    function validateProductPrice() {

      let regnum = new RegExp("^[0-9]+$");
      let productprice = $('#product_price').val()
      if (productprice.length == '') {

        $('#product_price').css('border-color', '#f30000')
        $('#product_price').attr("placeholder", "Enter Price")
        productPriceError = false;
        return false;

      } else if (!regnum.test(productprice)) {

        $('#product_price').css('border-color', '#f30000')
        $("#pricewarn").text('Enter Number Only')


        productPriceError = false;
      }
    }

    // product quantity
    let productQuantityError = true;

    function validateProducQuantity() {

      let regnum = new RegExp("^[0-9]+$");
      let productquantity = $('#product_quantity').val()
      if (productquantity.length == '') {

        $('#product_quantity').css('border-color', '#f30000')
        $('#product_quantity').attr("placeholder", "Enter Quantity")
        productQuantityError = false;
        return false;

      } else if (!regnum.test(productquantity)) {

        $('#product_quantity').css('border-color', '#f30000')
        $("#quantitywarn").text('Enter Number Only')

        product2000QuantityError = false;
      }
    }
    // product size
    // let productSizeError = true;

    // function validateProducSize() {

    //   let productsize = $('#product_size').val()
    //   if (productsize.length == '') {

    //     $('#product_size').css('border-color', '#f30000')
    //     $('#product_size').attr("placeholder", "Enter Size")
    //     productSizeError = false;
    //     return false;

    //   }
    // }
    // product colour
    // let productColourError = true;

    // function validateProducColour() {

    //   let productcolour = $('#product_colour').val()
    //   if (productcolour.length == '') {

    //     $('#product_colour').css('border-color', '#f30000')
    //     $('#product_colour').attr("placeholder", "Enter Colour")
    //     productSizeError = false;
    //     return false;

    //   }
    // }
    // product category
    let productCategoryError = true;

    function validateProducCategory() {

      let productcategory = $('#getSubCat').val()
      if (productcategory == '') {

        $('#getSubCat').css('border-color', '#f30000')
        $('#getSubCat').attr("placeholder", "Select Category")
        productCategoryError = false;
        return false;

      }
    }
    // product subCategory
    let productSubCategoryError = true;

    function validateProducSubCategory() {

      let productsubcategory = $('#subcategory').val()
      if (productsubcategory == ' ') {

        $('#subcategory').css('border-color', '#f30000')
        $('#subcategory').attr("placeholder", "Select SubCategory")
        productSubCategoryError = false;
        return false;

      }
    }


    validateProductTitle()
    validateProductName()
    validateProductDiscription()
    validateProductPrice()
    validateProducQuantity()
    // validateProducSize()
    // validateProducColour()
    validateProducCategory()
    validateProducSubCategory()

    if (productNameError === true && productTitleError === true && productDisError === true && productPriceError === true && productQuantityError === true ) {

      return true

    } else {
      return false
    }
  }


</script>