<!-- ============================================================== -->
<!-- Start right Content here -->
<!-- ============================================================== -->
<div class="main-content">

    <div class="page-content">
        <div class="container-fluid">

            <!-- start page title -->
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                        <h4 class="">Product Management</h4>

                        <div class="page-title-right">
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item"><a href="javascript: void(0);">Admin</a></li>
                                <li class="breadcrumb-item active">Product Management</li>
                                <li class="breadcrumb-item active">Add Product</li>
                            </ol>
                        </div>

                    </div>
                </div>
            </div>
            <!-- end page title -->

            <section class="content-main" style="max-width: 720px">

                <div class="content-header">
                    <h2 class="content-title">Create product </h2>
                </div>

                <div class="card mb-4">
                    <div class="card-body">
                        <form id="uploadForm" action="/admin/add_product" enctype="multipart/form-data"
                            method="post">
                            <div class="mb-4">
                                <label for="product_name" class="form-label">Product Name</label>
                                <input type="text" name="productname" onchange="validateProductName()"
                                    placeholder="Enter Product Name" class="form-control" id="product_name">
                            </div>

                            <div class="mb-4">
                                <label class="form-label">Product description</label>
                                <textarea name="productdiscription" placeholder="Type here"
                                    onchange="validateProductDiscription()" id="product_description"
                                    class="form-control" rows="4"></textarea>
                            </div>

                            <div class="row gx-2">
                                <div class="col-sm-6 mb-3">
                                    <label class="form-label">Price</label>
                                    <input type="text" name="productprice" onchange="validateProductPrice()"
                                        placeholder="Enter Price" class="form-control" id="product_price">
                                    <span style="color: red;" class="" id="pricewarn"></span>
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="form-label">Quantity</label>
                                    <input type="text" name="productquantity" onchange="validateProducQuantity()"
                                        placeholder="Enter Quantity" class="form-control" id="product_quantity">
                                    <span style="color: red;" class="" id="quantitywarn"></span>
                                </div>
                            </div> <!-- row.// -->

                            <div class="row gx-2">
                                <div class="col-sm-6 mb-3">
                                    <label class="form-label">Size</label>
                                    <input type="text" name="productsize" onchange="validateProducSize()"
                                        placeholder="Enter Size" class="form-control" id="product_size">
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="form-label">Colour</label>
                                    <input type="text" name="productcolour" onchange="validateProducColour()"
                                        placeholder="Enter Colour" class="form-control" id="product_colour">
                                </div>
                            </div> <!-- row.// -->

                            <div class="row gx-2">
                                <div class="col-sm-6 mb-3">
                                    <label class="form-label">Category</label>
                                    <select id="getSubCat" onchange="getSubcategory()" class="form-select"
                                        name="productcategory">

                                        <option value="">Select</option>
                                        <%for(var i=0;i<data.length;i++){%>

                                            <option>
                                                <%=data[i].category%>
                                            </option>
                                            <%}%>

                                    </select>
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label class="form-label">Sub-category</label>
                                    <select id="subcategory" class="form-select" name="productsubcategory">

                                        <option id="" value=" ">Select</option>

                                    </select>
                                </div>
                            </div> <!-- row.// -->

                            <div class="row gx-2">
                                <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Image 1</label>
                                    <input class="form-control" type="file" id="image1" name="productimage1">
                                </div>

                               




                                <!-- end -->
                                <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Images 2</label>
                                    <input class="form-control" type="file" id="image2" name="productimage2">
                                </div>
                                <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Image 3</label>
                                    <input class="form-control" type="file" id="image3" name="productimage3">
                                </div>
                                <div class="mb-4 col-sm-6 mb-3">
                                    <label class="form-label">Image 4</label>
                                    <input class="form-control" type="file" id="image4" name="productimage4">
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary">Add item</button>

                        </form>
                    </div>
                </div> <!-- card end// -->


            </section> <!-- content-main end// -->
        </div>
        <!-- End Page-content -->
    </div>
    <!-- end main content-->

</div>
<!-- END layout-wrapper -->


<!-- JAVASCRIPT -->
<script src="/admin/libs/jquery/jquery.min.js"></script>
<!-- <script src="/admin/libs/bootstrap/js/bootstrap.bundle.min.js"></script> -->
<script src="/admin/libs/simplebar/simplebar.min.js"></script>
<!-- <script src="/admin/libs/node-waves/waves.min.js"></script> -->



</body>

<!-- croppy -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script> -->
<script src="https://foliotek.github.io/Croppie/croppie.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>



<!-- card end// -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>



<!-- start -->

    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script> -->
    <script src="https://foliotek.github.io/Croppie/croppie.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

<!-- end -->



<script type="text/javascript">



    $(".gambar").attr("src", "https://user.gadjian.com/static/images/personnel_boy.png");
    var $uploadCrop,
        tempFilename,
        rawImg,
        imageId;
    function readFile(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('.upload-demo').addClass('ready');
                $('#cropImagePop').modal('show');
                rawImg = e.target.result;
            }
            reader.readAsDataURL(input.files[0]);
        }
        else {
            swal("Sorry - you're browser doesn't support the FileReader API");
        }
    }

    $uploadCrop = $('#upload-demo').croppie({
        viewport: {
            width: 150,
            height: 200,
        },
        enforceBoundary: false,
        enableExif: true
    });
    $('#cropImagePop').on('shown.bs.modal', function () {
        // alert('Shown pop');
        $uploadCrop.croppie('bind', {
            url: rawImg
        }).then(function () {
            console.log('jQuery bind complete');
        });
    });

    $('.item-img').on('change', function () {
        imageId = $(this).data('id'); tempFilename = $(this).val();
        $('#cancelCropBtn').data('id', imageId); readFile(this);
    });
    $('#cropImageBtn').on('click', function (ev) {
        $uploadCrop.croppie('result', {
            type: 'base64',
            format: 'jpeg',
            size: { width: 150, height: 200 }
        }).then(function (resp) {
            $('#item-img-output').attr('src', resp);
            $('#cropImagePop').modal('hide');
        });
    });









    function getSubcategory() {

        let category = $('#getSubCat').val()
        $.ajax({

            url: '/admin/getSubCategory',
            method: 'post',
            data: { category: category },
            success: (response) => {

                // $('#subcategory').html = ''
                $("#subcategory").find('option').remove();
                for (var i = 0; i < response.length; i++) {

                    $("#subcategory").append('<option >' + response[i].name + '</option>');
                    // let sub = <option>response[i].name</option>
                    // $('#subcategory').html+= sub
                }

            }

        })
    }


    // validation

    function addProduct() {

            event.preventDefault()

        let productname = $('#product_name').val()
        let productdiscription = $('#product_description').val()
        let productprice = $('#product_price').val()
        let productquantity = $('#product_quantity').val()
        let productsize = $('#product_size').val()
        let productcolour = $('#product_colour').val()
        let productcategory = $('#getSubCat').val()
        let productsubcategory = $('#subcategory').val()

        // product name
        let productNameError = true;

        function validateProductName() {

            let productname = $('#product_name').val()
            if (productname.length == '') {

                $('#product_name').css('border-color', '#f30000')
                $('#product_name').attr("placeholder", "Enter Product Name")
                productNameError = false;
                return false;

            }
        }

        // product discription
        let productDisError = true;

        function validateProductDiscription() {

            let productdiscription = $('#product_description').val()
            if (productdiscription.length == '') {

                $('#product_description').css('border-color', '#f30000')
                $('#product_description').attr("placeholder", "Enter Product Details")
                productDisError = false;
                return false;

            }
        }

        // product price
        let productPriceError = true;

        function validateProductPrice() {

            let regnum = new RegExp("^[0-9]+$");
            let productprice = $('#product_price').val()
            if (productprice.length == '') {

                $('#product_price').css('border-color', '#f30000')
                $('#product_price').attr("placeholder", "Enter Price")
                productPriceError = false;
                return false;

            } else if (!regnum.test(productprice)) {

                $('#product_price').css('border-color', '#f30000')
                $("#pricewarn").text('Enter Number Only')


                productPriceError = false;
            }
        }

        // product quantity
        let productQuantityError = true;

        function validateProducQuantity() {

            let regnum = new RegExp("^[0-9]+$");
            let productquantity = $('#product_quantity').val()
            if (productquantity.length == '') {

                $('#product_quantity').css('border-color', '#f30000')
                $('#product_quantity').attr("placeholder", "Enter Quantity")
                productQuantityError = false;
                return false;

            } else if (!regnum.test(productquantity)) {

                $('#product_quantity').css('border-color', '#f30000')
                $("#quantitywarn").text('Enter Number Only')

                product2000QuantityError = false;
            }
        }
        // product size
        let productSizeError = true;

        function validateProducSize() {

            let productsize = $('#product_size').val()
            if (productsize.length == '') {

                $('#product_size').css('border-color', '#f30000')
                $('#product_size').attr("placeholder", "Enter Size")
                productSizeError = false;
                return false;

            }
        }
        // product colour
        let productColourError = true;

        function validateProducColour() {

            let productcolour = $('#product_colour').val()
            if (productcolour.length == '') {

                $('#product_colour').css('border-color', '#f30000')
                $('#product_colour').attr("placeholder", "Enter Colour")
                productSizeError = false;
                return false;

            }
        }
        // product category
        let productCategoryError = true;

        function validateProducCategory() {

            let productcategory = $('#getSubCat').val()
            if (productcategory == '') {

                $('#getSubCat').css('border-color', '#f30000')
                $('#getSubCat').attr("placeholder", "Select Category")
                productCategoryError = false;
                return false;

            }
        }
        // product subCategory
        let productSubCategoryError = true;

        function validateProducSubCategory() {

            let productsubcategory = $('#subcategory').val()
            if (productsubcategory == ' ') {

                $('#subcategory').css('border-color', '#f30000')
                $('#subcategory').attr("placeholder", "Select SubCategory")
                productSubCategoryError = false;
                return false;

            }
        }

        

        validateProductName()
        validateProductDiscription()
        validateProductPrice()
        validateProducQuantity()
        validateProducSize()
        validateProducColour()
        validateProducCategory()
        validateProducSubCategory()

            if (productNameError === true && productDisError === true && productPriceError === true && productQuantityError === true && productSizeError === true && productColourError === true ) {
                console.log();

                return true
                // $.ajax({

                //     url:'/admin/add_product',
                //     method:'post',
                //     enctype:"multipart/form-data",
                //     data:addedProducts
                // })


            }


    }









</script>