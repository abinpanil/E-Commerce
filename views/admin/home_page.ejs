<link rel="stylesheet" href=/admin/cropper.css">


<!-- ============================================================== -->
<!-- Start right Content here -->
<!-- ============================================================== -->
<div class="main-content">

    <div class="page-content">
        <div class="container-fluid" id="table_change">

            <!-- start page title -->
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                        <h4 class="mb-sm-0">Home Customise</h4>

                        <div class="page-title-right">
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item"><a href="javascript: void(0);">Admin</a></li>
                                <li class="breadcrumb-item active">Home Customise</li>
                            </ol>
                        </div>

                    </div>
                </div>
            </div>
            <!-- end page title -->

            <div class="card" id="table_change">
                <div class="card-body" id="">
                    <div class="row">
                        <div class="col-md-4">

                            <form id="form" action="/admin/addbanner" method="post" enctype="multipart/form-data">


                                <div class="mb-4 mb-3">
                                    <label class="cabinet center-block">
                                        <figure>
                                            <img style=" width: 500px; height: 158px;"
                                                src="/user/images/imgplaceholder.png"
                                                class="gambar img-responsive img-thumbnail" id="chekPreview1"
                                                style="max-width: 200px; " />
                                        </figure>
                                        <input type="file" id="image1" class="item-img1 file center-block"
                                            accept="image/gif, image/jpeg, image/png" name="bannerimg" />
                                        <textarea name="image" id="imageValue1" cols="30" rows="10" hidden></textarea>
                                    </label>
                                    <div class="modal fade" id="modal1" tabindex="-1" role="dialog"
                                        aria-labelledby="myModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                                    <h4 class="modal-title" id="myModalLabel">
                                                        <?=multiLanguage( "Edit Foto" , "Edit Photo" )?>
                                                    </h4>
                                                </div>
                                                <div class="modal-body">
                                                    <div id="upload-demo1" style=" height: 250px; padding-bottom:25px;"
                                                        class="center-block">
                                                        <img src="" id="sampleImage1"
                                                            style="width:100px; height:100px" />
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-default"
                                                        data-dismiss="modal">Close</button>
                                                    <button type="button" id="crop1"
                                                        class="btn btn-primary">Crop</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <label class="form-label">Banner Title</label>
                                    <input type="text" placeholder="Type here" name="bannerTitle" class="form-control"
                                        id="banner_title" />
                                </div>
                                <div class="mb-4">
                                    <label class="form-label">Banner Heading</label>
                                    <input type="text" placeholder="Type here" name="bannerHeading" class="form-control"
                                        id="banner_heading" />
                                </div>
                                <div class="mb-4">
                                    <label class="form-label">Banner Content</label>
                                    <input type="text" placeholder="Type here" name="bannerContent" class="form-control"
                                        id="banner_content" />
                                </div>



                                <div class="d-grid pb-3">
                                    <button class="btn btn-primary" type="submit">Create
                                        Banner</button>

                                </div>
                            </form>
                            <hr>
                        </div>
                        <div class="col-md-8">
                            <table id="datatable-buttons"
                                class="table table-striped table-bordered dt-responsive nowrap"
                                style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th>banner</th>
                                        <th>Title</th>
                                        <th>Headding</th>
                                        <th>Content</th>
                                        <th class="text-end">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <%for(i=0;i<data.length;i++){%>
                                        <tr id="tr_<%=data[i]._id%>">
                                            <td><img style="width: 50px;height: 50px;"
                                                    src="/user/images/productImage/<%=data[i]._id%>1.jpg" alt="image">
                                            </td>
                                            <td>
                                                <%=data[i].bannerTitle%>
                                            </td>
                                            <td>
                                                <%=data[i].bannerHeading%>
                                            </td>
                                            <td>
                                                <%=data[i].bannerContent%>
                                            </td>
                                            <td><a class="btn btn-danger"
                                                    onclick="deleteBanner('<%=data[i]._id%>')">Delete</a></td>
                                        </tr>
                                        <%}%>
                                </tbody>
                            </table>
                        </div> <!-- .col// -->
                    </div> <!-- .row // -->
                </div> <!-- card body .// -->
            </div> <!-- card .// -->
        </div>
        <!-- End Page-content -->
    </div>
    <!-- end main content-->

</div>
<!-- END layout-wrapper -->




<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

<!-- JAVASCRIPT -->
<script src="/admin/libs/jquery/jquery.min.js"></script>
<script src="/admin/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/admin/libs/metismenu/metisMenu.min.js"></script>
<script src="/admin/libs/simplebar/simplebar.min.js"></script>
<script src="/admin/libs/node-waves/waves.min.js"></script>


<!-- sweat alert -->
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- <script src="sweetalert2.all.min.js"></script> -->

<script src="/admin/js/app.js"></script>
<!-- ajax -->

<script src="/admin/js/cropper.js"></script>


<link rel="stylesheet" href="https://unpkg.com/dropzone/dist/dropzone.css" />
<link href="https://unpkg.com/cropperjs/dist/cropper.css" rel="stylesheet" />

<script src="https://unpkg.com/dropzone"></script>
<script src="https://unpkg.com/cropperjs"></script>




<script>

    function deleteBanner(id) {

        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {

                $.ajax({

                    url: '/admin/deleteBanner',
                    type: 'post',
                    data: { id: id },
                    success: () => {

                        Swal.fire(

                            'Deleted!',
                            'Your file has been deleted.',
                            'success',

                        )
                        $("#table_change").load(location.href + " #table_change");

                    }

                })

            }
        })
    }







    function addbanner() {

        console.log("ethyyyyyyyy");
        event.preventDefault()


        let bannerTitleError = true;

        function validateBannerTitle() {

            let bannertitle = $('#banner_title').val()
            if (bannertitle.length == '') {

                $('#banner_title').css('border-color', '#f30000')
                $('#banner_title').attr("placeholder", "Enter Title")
                bannerTitleError = false;
                return false;

            }
        }

        let bannerHeadingError = true;

        function validateBannerHeading() {

            let bannerheading = $('#banner_heading').val()
            if (bannerheading.length == '') {

                $('#banner_heading').css('border-color', '#f30000')
                $('#banner_heading').attr("placeholder", "Enter Heading")
                bannerHeadingError = false;
                return false;

            }
        }

        let bannerContentError = true;

        function validateBannerContent() {

            let bannercontent = $('#banner_content').val()
            if (bannercontent.length == '') {

                $('#banner_content').css('border-color', '#f30000')
                $('#banner_content').attr("placeholder", "Enter Content")
                bannerContentError = false;
                return false;

            }
        }

        console.log("ivdeeem");

        validateBannerContent()
        validateBannerHeading()
        validateBannerTitle()


        if (bannerTitleError === true && bannerHeadingError === true && bannerContentError === true) {

            console.log("innnnnn");
            return true
        } else {
            console.log("outtttt");
            return false
        }




    }




    $('document').ready(function () {
        //modal1 and image 1
        var image1 = document.getElementById('sampleImage1');
        var modal1 = $('#modal1');
        var cropper1;

        $('#image1').change(function (event) {
            var files = event.target.files;

            var done = function (url) {
                image1.src = url;
                modal1.modal('show');
            };

            if (files && files.length > 0) {
                reader = new FileReader();
                reader.onload = function (event) {
                    done(reader.result);
                };
                reader.readAsDataURL(files[0]);
            }
        });

        modal1.on('shown.bs.modal', function () {
            cropper1 = new Cropper(image1, {
                aspectRatio: 3.17 / 1,
                viewMode: 1,
                preview: '#preview1'
            });
        }).on('hidden.bs.modal', function () {
            cropper1.destroy();
            cropper1 = null;
        });

        $('#crop1').click(function () {
            canvas = cropper1.getCroppedCanvas({
                width: 1903,
                height: 600
            });

            canvas.toBlob(function (blob) {
                url = URL.createObjectURL(blob);
                var reader = new FileReader();
                reader.readAsDataURL(blob);
                reader.onloadend = function () {
                    var base64data = reader.result;
                    modal1.modal('hide');
                    $("#imageValue1").val(base64data)
                    $('#chekPreview1').attr('src', base64data);
                };
            });
        });
        //modal1 and image 1 end



    });



</script>