<!-- Start of Main -->
<main class="main">
    <!-- Start of Breadcrumb -->
    <nav class="breadcrumb-nav">
        <div class="container">
            <ul class="breadcrumb bb-no">
                <li><a href="/">Home</a></li>
                <!-- <li><a href="#"></a></li> -->
                <li>List Products</li>
            </ul>
        </div>
    </nav>
    <!-- End of Breadcrumb -->

    <!-- Start of Page Content -->
    <div class="page-content mb-10">
        <div class="container">

            <!-- Start of Shop Content -->
            <div class="shop-content">
                <!-- Start of Shop Main Content -->
                <div class="main-content">
                    <!-- <nav class="toolbox sticky-toolbox sticky-content fix-top">
                        <div class="toolbox-left">
                            <a href="#" class="btn btn-primary btn-outline btn-rounded left-sidebar-toggle 
                                btn-icon-left"><i class="w-icon-category"></i><span>Filters</span></a>
                            <div class="toolbox-item toolbox-sort select-box text-dark">
                                <label>Sort By :</label>
                                <select name="orderby" class="form-control">
                                    <option value="default" selected="selected">Default sorting</option>
                                    <option value="popularity">Sort by popularity</option>
                                    <option value="rating">Sort by average rating</option>
                                    <option value="date">Sort by latest</option>
                                    <option value="price-low">Sort by pric: low to high</option>
                                    <option value="price-high">Sort by price: high to low</option>
                                </select>
                            </div>
                        </div>
                        <div class="toolbox-right">
                            <div class="toolbox-item toolbox-show select-box">
                                <select name="count" class="form-control">
                                    <option value="9">Show 9</option>
                                    <option value="12" selected="selected">Show 12</option>
                                    <option value="24">Show 24</option>
                                    <option value="36">Show 36</option>
                                </select>
                            </div>
                            <div class="toolbox-item toolbox-layout">
                                <a href="shop-fullwidth-banner.html" class="icon-mode-grid btn-layout active">
                                    <i class="w-icon-grid"></i>
                                </a>
                                <a href="shop-list.html" class="icon-mode-list btn-layout">
                                    <i class="w-icon-list"></i>
                                </a>
                            </div>
                        </div>
                    </nav> -->
                    <%if(pro.length){%>
                        <div class="product-wrapper row cols-lg-5 cols-md-4 cols-sm-3 cols-2 pt-5">


                            <%for(i=0;i<pro.length;i++){%>

                                <div class="product-wrap">
                                    <div class="product text-center">
                                        <figure class="product-media">
                                            <a href="/viewproduct/<%=pro[i]._id%>">
                                                <img src="/user/images/productImage/<%=pro[i]._id%>1.jpg" alt="Product"
                                                    width="300" height="338" />
                                                <img src="/user/images/productImage/<%=pro[i]._id%>1.jpg" alt="Product"
                                                    width="300" height="338" />
                                            </a>
                                            <div class="product-action-horizontal">
                                                <a onclick="addToCart('<%=pro[i]._id%>')"
                                                    class="btn-product-icon w-icon-cart" title="Add to cart"></a>

                                                    <%if(user.status){%>
                                                        <%let flag = 0%>
                                                        <%for(j=0;j<checkWishlist.length;j++){%>
                                                            <%if(checkWishlist[j] == pro[i]._id){%>
                                                                <%flag = 1%>
                                                                <%break%>
                                                            <%}%>
                                                        <%}%>
                                                        <%if(flag===1){%>
                                                            <a onclick="addToWishlist('active','<%=pro[i]._id%>')" id="wish-btn-active_<%=pro[i]._id%>"
                                                                style="color: red;" class="btn-product-icon w-icon-heart-full" title="Wishlist"></a>
                                                        <%}else{%>
                                                            <a onclick="addToWishlist('desable','<%=pro[i]._id%>')" id="wish-btn-desable_<%=pro[i]._id%>"
                                                                style="color: red;" class="btn-product-icon w-icon-heart" title="Wishlist"></a>
                                                        <%}%>
                                                    <%}else{%>
                                                        <a onclick="addToWishlist('<%=pro[i]._id%>')" 
                                                            style="color: red;" class="btn-product-icon w-icon-heart" title="Wishlist"></a>
                                                    <%}%>



                                                <a href="/product-buy-now/<%=pro[i]._id%>"
                                                    class="btn-product-icon w-icon-shipping" title="Buy Now"></a>
                                            </div>
                                        </figure>
                                        <div class="product-details">
                                            <div class="product-cat">
                                                <a href="/viewproduct/<%=pro[i]._id%>"><b>
                                                        <%=pro[i].producttitle%>
                                                    </b></a>
                                            </div>
                                            <h3 class="product-name">
                                                <a href="/viewproduct/<%=pro[i]._id%>">
                                                    <%=pro[i].productname%>
                                                </a>
                                            </h3>
                                            <div class="ratings-container">
                                                <!-- <div class="ratings-full">
                                                <span class="ratings" style="width: 100%;"></span>
                                                <span class="tooltiptext tooltip-top"></span>
                                            </div> -->
                                                <!-- <a href="product-default.html" class="rating-reviews">(1 reviews)</a> -->
                                            </div>


                                            <%if(pro[i].isOfferActive===true){%>

                                                <%if(pro[i].isProOfferActive===true){%>

                                                    <%if(pro[i].offer_price> pro[i].productoffer_price){%>

                                                        <p style="color: green; padding: 0; margin: 0;">
                                                            <%=pro[i].productoffer_description%>
                                                        </p>
                                                        <div class="product-pa-wrapper">
                                                            <div class="product-price" style="color: grey;">Rs.
                                                                <del>
                                                                    <%=pro[i].productprice%>
                                                                </del>
                                                            </div>
                                                        </div>
                                                        <div class="product-pa-wrapper">
                                                            <div class="product-price" style="color: green;">Rs.
                                                                <%=pro[i].productoffer_price%>
                                                            </div>
                                                        </div>
                                                        <p style="color: green;"></p>

                                                        <%}else{%>

                                                            <p style="color: green; padding: 0; margin: 0;">
                                                                <%=pro[i].categoryoffer_description%>
                                                            </p>
                                                            <div class="product-pa-wrapper">
                                                                <div class="product-price" style="color: grey;">Rs.
                                                                    <del>
                                                                        <%=pro[i].productprice%>
                                                                    </del>
                                                                </div>
                                                            </div>
                                                            <div class="product-pa-wrapper">
                                                                <div class="product-price" style="color: green;">Rs.
                                                                    <%=pro[i].offer_price%>
                                                                </div>
                                                            </div>
                                                            <p style="color: green;"></p>

                                                            <%}%>

                                                                <%}else{%>

                                                                    <p style="color: green; padding: 0; margin: 0;">
                                                                        <%=pro[i].categoryoffer_description%>
                                                                    </p>
                                                                    <div class="product-pa-wrapper">
                                                                        <div class="product-price" style="color: grey;">
                                                                            Rs.
                                                                            <del>
                                                                                <%=pro[i].productprice%>
                                                                            </del>
                                                                        </div>
                                                                    </div>
                                                                    <div class="product-pa-wrapper">
                                                                        <div class="product-price"
                                                                            style="color: green;">Rs.
                                                                            <%=pro[i].offer_price%>
                                                                        </div>
                                                                    </div>
                                                                    <p style="color: green;"></p>

                                                                    <%}%>

                                                                        <%}else if(pro[i].isProOfferActive===true){%>

                                                                            <p
                                                                                style="color: green; padding: 0; margin: 0;">
                                                                                <%=pro[i].productoffer_description%>
                                                                            </p>
                                                                            <div class="product-pa-wrapper">
                                                                                <div class="product-price"
                                                                                    style="color: grey;">Rs.
                                                                                    <del>
                                                                                        <%=pro[i].productprice%>
                                                                                    </del>
                                                                                </div>
                                                                            </div>
                                                                            <div class="product-pa-wrapper">
                                                                                <div class="product-price"
                                                                                    style="color: green;">Rs.
                                                                                    <%=pro[i].productoffer_price%>
                                                                                </div>
                                                                            </div>
                                                                            <p style="color: green;"></p>

                                                                            <%}else{%>

                                                                                <div class="product-pa-wrapper">
                                                                                    <div class="product-price">Rs.
                                                                                        <%=pro[i].productprice%>
                                                                                    </div>
                                                                                </div>

                                                                                <%}%>




                                        </div>
                                    </div>
                                </div>

                                <%}%>


                        </div>

                        <%}else{%>


                            <div style="height: 50vh;" class="d-flex justify-content-center align-items-center">
                                <h1>No Items Yet!!!!!</h1>
                            </div>


                            <%}%>

                                <!-- <div class="toolbox toolbox-pagination justify-content-between"> -->
                                <!-- <p class="showing-info mb-2 mb-sm-0">
                            Showing<span>1-15 of 60</span>Products
                        </p> -->
                                <!-- <ul class="pagination">
                            <li class="prev disabled">
                                <a href="#" aria-label="Previous" tabindex="-1" aria-disabled="true">
                                    <i class="w-icon-long-arrow-left"></i>Prev
                                </a>
                            </li>
                            <li class="page-item active">
                                <a class="page-link" href="#">1</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">2</a>
                            </li>
                            <li class="next">
                                <a href="#" aria-label="Next">
                                    Next<i class="w-icon-long-arrow-right"></i>
                                </a>
                            </li>
                        </ul> -->
                </div>
            </div>
            <!-- End of Shop Main Content -->

            <!-- Start of Sidebar, Shop Sidebar -->
            <aside class="sidebar shop-sidebar left-sidebar sticky-sidebar-wrapper">
                <!-- Start of Sidebar Overlay -->
                <div class="sidebar-overlay"></div>
                <a class="sidebar-close" href="#"><i class="close-icon"></i></a>

                <!-- Start of Sidebar Content -->
                <div class="sidebar-content scrollable">
                    <div class="filter-actions">
                        <label>Filter :</label>
                        <a href="#" class="btn btn-dark btn-link filter-clean">Clean All</a>
                    </div>
                    <!-- Start of Collapsible widget -->
                    <div class="widget widget-collapsible">
                        <h3 class="widget-title"><span>All Categories</span></h3>
                        <ul class="widget-body filter-items search-ul">
                            <li><a href="#">Accessories</a></li>
                            <li><a href="#">Babies</a></li>
                            <li><a href="#">Beauty</a></li>
                            <li><a href="#">Decoration</a></li>
                            <li><a href="#">Electronics</a></li>
                            <li><a href="#">Fashion</a></li>
                            <li><a href="#">Food</a></li>
                            <li><a href="#">Furniture</a></li>
                            <li><a href="#">Kitchen</a></li>
                            <li><a href="#">Medical</a></li>
                            <li><a href="#">Sports</a></li>
                            <li><a href="#">Watches</a></li>
                        </ul>
                    </div>
                    <!-- End of Collapsible Widget -->

                    <!-- Start of Collapsible Widget -->
                    <div class="widget widget-collapsible">
                        <h3 class="widget-title"><span>Price</span></h3>
                        <div class="widget-body">
                            <ul class="filter-items search-ul">
                                <li><a href="#">$0.00 - $100.00</a></li>
                                <li><a href="#">$100.00 - $200.00</a></li>
                                <li><a href="#">$200.00 - $300.00</a></li>
                                <li><a href="#">$300.00 - $500.00</a></li>
                                <li><a href="#">$500.00+</a></li>
                            </ul>
                            <form class="price-range">
                                <input type="number" name="min_price" class="min_price text-center"
                                    placeholder="$min"><span class="delimiter">-</span><input type="number"
                                    name="max_price" class="max_price text-center" placeholder="$max"><a href="#"
                                    class="btn btn-primary btn-rounded">Go</a>
                            </form>
                        </div>
                    </div>
                    <!-- End of Collapsible Widget -->

                    <!-- Start of Collapsible Widget -->
                    <div class="widget widget-collapsible">
                        <h3 class="widget-title"><span>Size</span></h3>
                        <ul class="widget-body filter-items item-check mt-1">
                            <li><a href="#">Extra Large</a></li>
                            <li><a href="#">Large</a></li>
                            <li><a href="#">Medium</a></li>
                            <li><a href="#">Small</a></li>
                        </ul>
                    </div>
                    <!-- End of Collapsible Widget -->

                    <!-- Start of Collapsible Widget -->
                    <div class="widget widget-collapsible">
                        <h3 class="widget-title"><span>Brand</span></h3>
                        <ul class="widget-body filter-items item-check mt-1">
                            <li><a href="#">Elegant Auto Group</a></li>
                            <li><a href="#">Green Grass</a></li>
                            <li><a href="#">Node Js</a></li>
                            <li><a href="#">NS8</a></li>
                            <li><a href="#">Red</a></li>
                            <li><a href="#">Skysuite Tech</a></li>
                            <li><a href="#">Sterling</a></li>
                        </ul>
                    </div>
                    <!-- End of Collapsible Widget -->

                    <!-- Start of Collapsible Widget -->
                    <div class="widget widget-collapsible">
                        <h3 class="widget-title"><span>Color</span></h3>
                        <ul class="widget-body filter-items item-check">
                            <li><a href="#">Black</a></li>
                            <li><a href="#">Blue</a></li>
                            <li><a href="#">Brown</a></li>
                            <li><a href="#">Green</a></li>
                            <li><a href="#">Grey</a></li>
                            <li><a href="#">Orange</a></li>
                            <li><a href="#">Yellow</a></li>
                        </ul>
                    </div>
                    <!-- End of Collapsible Widget -->
                </div>
                <!-- End of Sidebar Content -->
            </aside>
            <!-- End of Shop Sidebar -->
        </div>
        <!-- End of Shop Content -->
    </div>
    </div>
    <!-- End of Page Content -->
</main>
<!-- End of Main -->

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>


function addToWishlist(name,id) {
        console.log(name);
        $.ajax({
            url: '/add-to-wishlist',
            method: 'post',
            data: { proId: id },
            success: (response) => {
                
                if (response.login === true) {

                    if (response.status === 1) {
                        $(`#wish-btn-${name}_${id}`).removeClass('w-icon-heart')
                        
                        $(`#wish-btn-${name}_${id}`).addClass('w-icon-heart-full')
                        
                        var toastMixin = Swal.mixin({
                            toast: true,
                            icon: 'success',
                            title: 'General Title',
                            animation: false,
                            position: 'top-right',
                            showConfirmButton: false,
                            timer: 3000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        });

                        toastMixin.fire({
                            animation: true,
                            title: 'Product Added to Wishlist'
                        });
                    }else if(response.status === 2){
                        $(`#wish-btn-${name}_${id}`).removeClass('w-icon-heart-full')
                        
                        $(`#wish-btn-${name}_${id}`).addClass('w-icon-heart')
                        
                        var toastMixin = Swal.mixin({
                            toast: true,
                            icon: 'success',
                            title: 'General Title',
                            animation: false,
                            position: 'top-right',
                            showConfirmButton: false,
                            timer: 3000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        });

                        toastMixin.fire({
                            animation: true,
                            title: 'Product removed from Wishlist'
                        });
                    }

                } else {
                    window.location.assign('/login')
                }

            }
        })
    }


    function addToCart(id) {

        console.log(id);
        $.ajax({
            url: '/add-to-cart',
            method: 'post',
            data: { proId: id },
            success: (response) => {
                if (response.status) {

                    let count = $('#cart_count').html()
                    $('#cart_count').html(parseInt(count) + 1)

                    var toastMixin = Swal.mixin({
                            toast: true,
                            icon: 'success',
                            title: 'General Title',
                            animation: false,
                            position: 'top-right',
                            showConfirmButton: false,
                            timer: 3000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        });

                        toastMixin.fire({
                            animation: true,
                            title: 'Item Added to Cart'
                        });
                } else {
                    window.location.assign('/login')

                }

            }
        })

    }


</script>